<!doctype html>
<head>
  
<meta charset="utf-8">

  
<title>My Parse App</title>
  
<meta name="description" content="My Parse App">
  
<meta name="viewport" content="width=device-width">
  

  
<link rel="stylesheet" href="css/styles.css">
  
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
  <script type="text/javascript" src="http://www.parsecdn.com/js/parse-1.5.0.min.js"></script>

</head>

<body>
  
  
<div id="main">
    <h1><p>LMES - ADMIN PANEL </p></h1>
<table>
<tr>
<td><input type="text" placeholder="Title" id="title" name="title"></td>

<td><input type="text" placeholder="Link" id="link" name="link"></td>

<td><select name="cate" id="cat">
  <option value="maths">Maths</option>
  <option value="science">Science</option>
  <option value="physics">Physics</option>
  <option value="chemistry">Chemistry</option>
</select></td>
<td>


<input type="button" onclick="validateForm()" value="Submit"></button></td>
</tr>
</table>
<div id="error" class="error">

</div>
</form>

<div>
<h3><p><b>Current Videos</b></p></h3>
</div>
<table id="listing" class="new" border="1px" cellpadding="1px">

</table>


</div>

 
<div>

</div> 

</body>

</html>


<script type="text/javascript">

Parse.initialize("x6zuWvAxpkxKw3hHsFQL43Z4311Mxqt2jSdXjIFs", "ma4pU7RJaQSHpFnrmLRuK9vDvgNcWCXSoD4kktWh");

function validateForm() {

   	var title = document.getElementById('title').value;   
	var lin = document.getElementById('link').value;
	var link=lin.trim();
var regex = new RegExp("^(http[s]?:\\/\\/(www\\.)?|ftp:\\/\\/(www\\.)?|www\\.){1}([0-9A-Za-z-\\.@:%_\+~#=]+)+((\\.[a-zA-Z]{2,3})+)(/(.)*)?(\\?(.)*)?");
    if (title == null || title == "") {
        //alert("Title must be filled out");
        document.getElementById("error").innerHTML = "Title must be filled out";
return false;
    }
	else if(link == null || link == ""){
  //alert("Link must be filled out");
        document.getElementById("error").innerHTML = "Link must be filled out";
		
return false;
    }
	else if(!regex.test(link)){
        document.getElementById("error").innerHTML = "Link must be a Valid URL";
	return false;
  }
  else
  {
  myExits(link);
		//return false;
  }

}
function myExits(url)
{
var GameScore = Parse.Object.extend("jj");
var query = new Parse.Query(GameScore);

query.equalTo("link", url);
query.find({
  success: function(results) {
  if (results.length > 0) {
  document.getElementById("error").innerHTML = "Link URL Already Exits";

  alert("Link URL Alredy Exists");
	return false;
  }else
  {
  myFunction();
  }
    }
	});
//alert("function return"+check);

}

function myFunction() {
var title = document.getElementById('title').value;   
var lin = document.getElementById('link').value;
var link=lin.trim();
var cate = document.getElementById('cat').value;
var GameScore = Parse.Object.extend("jj");
var gameScore = new GameScore();


gameScore.set("title", title);
gameScore.set("category", cate);
gameScore.set("link", link);
gameScore.set("createdby", "admin");

gameScore.save(null, {
  success: function(gameScore) {
    // Execute any logic that should take place after the object is saved.
    //alert('New object created with objectId: ' + gameScore.objectId);
	window.location.reload(true);
  },
  error: function(gameScore, error) {
    // Execute any logic that should take place if the save fails.
    // error is a Parse.Error with an error code and message.
    alert('Failed to create new object, with error code: ' + error.message);
  }
});
}
var GameScore = Parse.Object.extend("jj");
var query = new Parse.Query(GameScore);

query.equalTo("createdby", "admin");
query.find({
  success: function(results) {
	//alert("Successfully retrieved " + results.length + " scores.");
    // Do something with the returned Parse.Object values
var myhtml = "";

myhtml += "<tr class='sty'><td>Title</td><td>Link</td><td>Category</td><td>Action</td></tr>"

    for (var i = 0; i < results.length; i++) {

      var object = results[i];
	  var id=object.get("objectId");

var title = object.get("title");
var link = object.get("link");
var category = object.get("category");
var id=object.id;
myhtml += "<tr><td>" + title +"</td>"
myhtml += "<td>"+link+"</td>"
myhtml += "<td>"+category+"</td>";
myhtml += "<td><img src='image/dele.png' height='16' width='16' onclick='myDelete(&apos;"+id+"&apos;)'></td></tr>";

      //alert(object.id + ' - ' + object.get('createdby'));
    }
listing.innerHTML += myhtml;

  },
  error: function(error) {
    alert("Error: " + error.code + " " + error.message);
  }
});




</script>
<script type="text/javascript">
function myDelete(id)
{
var GameScore = Parse.Object.extend("jj");
var query = new Parse.Query(GameScore);
query.get(id, {
  success: function(gameScore) {
    // The object was retrieved successfully.
 gameScore.destroy({});
alert("Delete Sucess");
window.location.reload(true);

  },
  error: function(object, error) {
    
  }
});
}
</script>

